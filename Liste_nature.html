<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liste de la Nature</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f0f0;
        }

        .diagram-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            max-width: 1000px;
            margin: 0 auto;
            position: relative;
            overflow: visible;
        }

        .level {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 8px;
            margin: 10px 0;
            min-height: 40px;
            position: relative;
            align-items: center;
        }

        .level-number {
            position: absolute;
            left: -30px;
            top: 50%;
            transform: translateY(-50%);
            background: white;
            border: 2px solid #000;
            border-radius: 4px;
            padding: 2px 6px;
            font-weight: bold;
            font-size: 12px;
        }

        .spell-node {
            background: white;
            border: 2px solid #000;
            border-radius: 6px;
            padding: 4px 8px;
            margin: 2px;
            text-align: center;
            font-size: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            min-width: 80px;
            z-index: 5;
        }

        .spell-node:hover {
            background-color: #e3f2fd;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .spell-node.clicked {
            background-color: #4a90e2;
            color: white;
        }

        .arrow {
            position: absolute;
            background: #000;
            z-index: 1;
            transform-origin: left center;
        }

        .arrow::after {
            content: '';
            position: absolute;
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-top: 8px solid #000;
            right: -6px;
            top: 50%;
            transform: translateY(-50%);
        }

        .arrow-vertical {
            width: 2px;
        }

        .arrow-diagonal {
            width: 2px;
        }

        .arrow-horizontal {
            height: 2px;
        }

        .arrow-horizontal::after {
            border-left: 8px solid #000;
            border-top: 6px solid transparent;
            border-bottom: 6px solid transparent;
            border-right: none;
            right: -8px;
            top: 50%;
            transform: translateY(-50%);
        }

        .connection-line {
            position: absolute;
            background: #000;
            z-index: 1;
        }

        .connection-line::after {
            content: '';
            position: absolute;
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-top: 8px solid #000;
            right: -6px;
            top: 50%;
            transform: translateY(-50%);
        }

        .diagram-svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
            pointer-events: none;
            overflow: visible;
        }

        h1 {
            text-align: center;
            color: #000;
            margin-bottom: 15px;
            font-size: 24px;
        }

        .spell-info {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border: 2px solid #000;
            border-radius: 8px;
            padding: 15px;
            max-width: 300px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            display: none;
            z-index: 1000;
        }

        .spell-info h3 {
            margin: 0 0 10px 0;
            color: #4a90e2;
        }

        .spell-info p {
            margin: 5px 0;
            font-size: 14px;
        }

        #spellDescription {
            text-align: justify;
        }

        /* Classes de positionnement par colonne */
        .col-1 {
            grid-column: 1;
        }

        .col-2 {
            grid-column: 2;
        }

        .col-3 {
            grid-column: 3;
        }

        .col-4 {
            grid-column: 4;
        }

        .col-5 {
            grid-column: 5;
        }

        .col-6 {
            grid-column: 6;
        }

        .col-7 {
            grid-column: 7;
        }

        .col-8 {
            grid-column: 8;
        }

        .col-2-3 {
            grid-column: 2 / 4;
        }

        /* Améliorations visuelles */
        .diagram-container {
            padding: 28px;
            border-radius: 14px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
            background: #fff;
        }

        .level {
            gap: 12px;
            margin: 18px 0;
            min-height: 56px;
        }

        .level-number {
            background: linear-gradient(180deg, #ffffff, #f3f3f3);
            border: 1px solid rgba(0, 0, 0, 0.5);
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
            padding: 4px 8px;
            font-size: 12px;
        }

        .spell-node {
            background: linear-gradient(180deg, #ffffff 0%, #f7f7f7 100%);
            border: 1px solid rgba(0, 0, 0, 0.12);
            border-radius: 10px;
            padding: 8px 12px;
            margin: 4px;
            font-size: 12px;
            min-width: 120px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
        }

        .spell-node:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 18px rgba(0, 0, 0, 0.15);
        }
    </style>
</head>

<body>
    <h1>LISTE DE LA NATURE</h1>


    <div class="diagram-container" id="diagramContainer">

        <!-- Niveau 1 -->
        <div class="level" style="margin-top: 0;">
            <div class="level-number">1</div>
            <div class="spell-node col-2" data-spell="Localisation des animaux">Localisation des animaux</div>
            <div class="spell-node col-4" data-spell="Connaissance des animaux">Connaissance des animaux</div>
            <div class="spell-node col-6" data-spell="Localisation des plantes">Localisation des plantes</div>
            <div class="spell-node col-7" data-spell="Connaissance des plantes">Connaissance des plantes</div>
        </div>

        <!-- Niveau 2 -->
        <div class="level">
            <div class="level-number">2</div>
            <div class="spell-node col-2" data-spell="Apaiser les animaux">Apaiser les animaux</div>
            <div class="spell-node col-4" data-spell="Langage animal">Langage animal</div>
            <div class="spell-node col-6" data-spell="Langage des plantes">Langage des plantes</div>
        </div>

        <!-- Niveau 3 -->
        <div class="level">
            <div class="level-number">3</div>
            <div class="spell-node col-3" data-spell="Amitié animale">Amitié animale</div>
        </div>

        <!-- Niveau 4 -->
        <div class="level">
            <div class="level-number">4</div>
            <div class="spell-node col-3" data-spell="Alliance">Alliance</div>
            <div class="spell-node col-4" data-spell="Toile d'araignée">Toile d'araignée</div>
            <div class="spell-node col-6" data-spell="Distorsion du bois">Distorsion du bois</div>
            <div class="spell-node col-7" data-spell="Accélération de la guérison">Accélération de la guérison</div>
        </div>

        <!-- Niveau 5 -->
        <div class="level">
            <div class="level-number">5</div>
            <div class="spell-node col-4" data-spell="Enchevêtrement">Enchevêtrement</div>
            <div class="spell-node col-6" data-spell="Mur d'épines">Mur d'épines</div>
            <div class="spell-node col-7" data-spell="Neutraliser le poison">Neutraliser le poison</div>
        </div>

        <!-- Niveau 6 -->
        <div class="level">
            <div class="level-number">6</div>
            <div class="spell-node col-2" data-spell="Invocation animale mineure">Invocation animale mineure</div>
            <div class="spell-node col-3" data-spell="Sens animaux">Sens animaux</div>
            <div class="spell-node col-6" data-spell="Armure d'écorce">Armure d'écorce</div>
        </div>

        <!-- Niveau 7 -->
        <div class="level">
            <div class="level-number">7</div>
            <div class="spell-node col-1" data-spell="Invocation d'insectes">Invocation d'insectes</div>
            <div class="spell-node col-3" data-spell="Forme animale">Forme animale</div>
            <div class="spell-node col-6" data-spell="Forme végétale">Forme végétale</div>
        </div>

        <!-- Niveau 8 -->
        <div class="level">
            <div class="level-number">8</div>
            <div class="spell-node col-4" data-spell="Fusion dans la nature">Fusion dans la nature</div>
        </div>

        <!-- Niveau 9 -->
        <div class="level">
            <div class="level-number">9</div>
            <div class="spell-node col-3" data-spell="Croissance animale">Croissance animale</div>
            <div class="spell-node col-4" data-spell="Télépathie avec la nature">Télépathie avec la nature</div>
            <div class="spell-node col-7" data-spell="Croissance végétale">Croissance végétale</div>
        </div>

        <!-- Niveau 10 -->
        <div class="level">
            <div class="level-number">10</div>
            <div class="spell-node col-4" data-spell="Communion avec la nature">Communion avec la nature</div>
            <div class="spell-node col-7" data-spell="Voyage naturel">Voyage naturel</div>
        </div>

        <!-- Niveau 12 -->
        <div class="level">
            <div class="level-number">12</div>
            <div class="spell-node col-4" data-spell="Protection contre la nature">Protection contre la nature</div>
        </div>

        <!-- Niveau 15 -->
        <div class="level">
            <div class="level-number">15</div>
            <div class="spell-node col-2" data-spell="Invocation animale majeure">Invocation animale majeure</div>
        </div>

        <!-- Niveau 20 -->
        <div class="level">
            <div class="level-number">20</div>
            <div class="spell-node col-2" data-spell="Chef de clan">Chef de clan</div>
            <div class="spell-node col-7" data-spell="Malédiction de la nature">Malédiction de la nature</div>
        </div>
    </div>
    <div class="spell-info" id="spellInfo">
        <h3><span id="spellName"></span> (niv <span id="spellLevel"></span>)</h3>
        <table>
            <tr>
                <td><strong>Portée :</strong></td>
                <td><span id="spellPortée"></span></td>
            </tr>
            <tr>
                <td><strong>Incantation :</strong></td>
                <td><span id="spellIncantation"></span></td>
            </tr>
        </table>
        <table>
            <tr>
                <td><strong>Durée :</strong></td>
                <td><span id="spellDurée"></span></td>
            </tr>
            <tr>
                <td><strong>Sauvegarde :</strong></td>
                <td><span id="spellSauvegarde"></span></td>
            </tr>
            <tr>
                <td><strong>Zone :</strong></td>
                <td><span id="spellZone"></span></td>
            </tr>
        </table>
        <p id="spellDescription"></p>
    </div>

    <script>
        // Données de la Liste de la Nature
        const spellsData = {
            // Niveau 1
            "Localisation des animaux": {
                level: 1,
                portée: "-",
                incantation: "5 s",
                durée: "1 min",
                sauvegarde: "-",
                zone: "boule de 30m *",
                description: "Par ce sort, le magicien obtient la possibilité de déterminer la position et la nature de tout animal dans la zone d'effet. Cette zone se déplace avec lui par la suite.\nCe sort utilise une lecture des ondes magiques qu'émet tout être vivant et qui suivent un motif dépendant de sa nature. La présence d'obstacles (porte fermée, mur, etc.) réduit fortement la zone d'effet.\nPar exception, ce sortilège affecte également les créatures humanoïdes intelligentes et les créatures surnaturelles. Sa précision concernant ces types de créatures est toutefois moindre que concernant les animaux : le magicien perçoit la présence de créatures humanoïdes ou surnaturelles mais ne les localise que de manière vague (plusieurs mètres d'incertitude) et n'identifie pas précisément leur type ou leur race."
            },
            "Connaissance des animaux": {
                level: 1,
                portée: "50 m",
                incantation: "5 s",
                durée: "-",
                sauvegarde: "-",
                zone: "une espèce animale",
                description: "Ce sortilège confère au magicien une connaissance assez complète d'une espèce animale ciblée (avec des précisions sur la race plus particulièrement concernée) : nourriture, méthodes de chasse ou de protection, rites amoureux, vie sociale… Le magicien a pour cela besoin de percevoir la présence d'au moins un individu de l'espèce concernée, soit en le voyant, soit en le décelant via un sort de Localisation des animaux.\nLa connaissance acquise par le magicien est générique et porte sur l'espèce et la race de l'individu concerné et aucunement sur ce représentant en particulier."
            },
            "Localisation des plantes": {
                level: 1,
                portée: "-",
                incantation: "5 s",
                durée: "1 min",
                sauvegarde: "-",
                zone: "boule de 30m *",
                description: "Par ce sort, le magicien obtient la possibilité de déterminer la position et la nature de tout végétal dans la zone d'effet. Ce sortilège fonctionne sur le même principe que celui de Localisation des animaux."
            },
            "Connaissance des plantes": {
                level: 1,
                portée: "50 m",
                incantation: "5 s",
                durée: "-",
                sauvegarde: "-",
                zone: "une espèce végétale",
                description: "Ce sortilège confère au magicien une connaissance assez complète d'une espèce végétale ciblée (avec des précisions sur la variété plus particulièrement concernée) : digestibilité, vertus nutritives ou curatives, dangerosité, protections, cycles de croissance, mode de reproduction… Le magicien a pour cela besoin de percevoir la présence d'au moins un individu de l'espèce concernée, soit en le voyant, soit en le décelant via un sort de Localisation des plantes.\nLa connaissance acquise par le magicien est générique et porte sur l'espèce et la variété de l'individu concerné et aucunement sur ce représentant en particulier."
            },

            // Niveau 2
            "Apaiser les animaux": {
                level: 2,
                portée: "20 m",
                incantation: "2 s",
                durée: "-",
                sauvegarde: "« Ch »",
                zone: "boule de 10m",
                description: "Ce sort rend calmes et non agressifs les animaux se trouvant dans la zone d'effet. Ils ne deviennent pas nécessairement amicaux, mais ne cherchent plus à combattre ou à tuer. Cependant, s'ils sont la cible d'une attaque, ils se défendent et redeviennent agressifs.\nLa sauvegarde inversée de ce sortilège consiste en un jet du magicien sous son propre attribut charisme. Le maître du jeu ajoute un bonus ou un malus (compris entre +4 et - 4) à ce jet de sauvegarde pour tenir compte de l'agressivité naturelle et du nombre des animaux concernés."
            },
            "Langage animal": {
                level: 2,
                portée: "30 m",
                incantation: "2 s",
                durée: "1 h",
                sauvegarde: "-",
                zone: "une espèce animale",
                description: "Le magicien acquiert par ce sortilège la possibilité de communiquer avec les représentants d'une espèce animale. Le sort renforce considérablement les modes d'expression habituels de l'espèce considérée, de sorte que, par mimes et sons, la communication entre le magicien et les représentants de cette espèce puisse réellement véhiculer des informations. Bien sûr, plus cette espèce aura naturellement un langage, ou plutôt un mode d'expression, évolué et complexe, et plus le magicien pourra échanger d'informations avec elle.\nCe sort rend les animaux de cette espèce bien disposés envers le magicien. Ils le renseigneront dans la mesure de leurs connaissances et l'aideront si cela ne semble pas présenter de danger réel. Avoir lancé ce sort confère de ce fait un bonus de +2 au jet de sauvegarde du magicien pour les sorts Apaiser les animaux et Amitié animale concernant l'espèce en question."
            },
            "Langage des plantes": {
                level: 2,
                portée: "30 m",
                incantation: "2 s",
                durée: "1 h",
                sauvegarde: "-",
                zone: "une espèce végétale",
                description: "Le magicien acquiert par ce sortilège la possibilité de communiquer avec les représentants d'une espèce végétale. Le sort confère à l'espèce considérée la capacité de produire et de comprendre des sons, de sorte que la communication entre le magicien et les représentants de cette espèce puisse réellement véhiculer des informations. Le degré de complexité du langage conféré, et donc la précision des informations pouvant être transmises, dépend grandement du degré d'évolution du végétal et de sa taille. Les grands arbres pourront par exemple exprimer presque autant de nuances qu'un humanoïde, tandis qu'une touffe d'herbe s'exprimera aussi bien qu'un enfant de 2 ans.\nCe sort rend les végétaux de cette espèce bien disposés envers le magicien. Ils le renseigneront dans la mesure de leurs connaissances et l'aideront si cela ne semble pas présenter de danger réel."
            },

            // Niveau 3
            "Amitié animale": {
                level: 3,
                portée: "30 m",
                incantation: "2 s",
                durée: "2 h",
                sauvegarde: "« Mag »",
                zone: "100 pv d'animaux",
                description: "Ce sort permet au magicien d'obtenir l'assistance et le soutien d'un certain nombre d'animaux (qui doivent être relativement regroupés). Le sort affecte les animaux choisis par le magicien dans la limite où la somme de leurs points de vie n'excède pas 100 (sinon seule une partie des animaux visés est affectée).\nSi le sort réussit, les animaux en question seront amicaux envers le magicien et ses amis et essaieront de l'aider ou de le renseigner dans la mesure de leurs moyens et pour autant que cela ne les expose pas à des risques trop importants pour leur vie.\nLa sauvegarde inversée de ce sortilège consiste en un jet du magicien sous son propre don Magie avec les ajustements suivants :\n- « sociabilité » des animaux envers un humanoïde : de +6 (chien) à -6 (requin).\n- humeur : de +6 (calme absolu) à -6 (fureur).\n- avantage Empathie animale : +1\n- sort actif de Langage animal : +2"
            },

            // Niveau 4
            "Alliance": {
                level: 4,
                portée: "2 m",
                incantation: "5 min",
                durée: "permanent",
                sauvegarde: "-",
                zone: "1 animal",
                description: "Ce sort nécessite d'avoir établi au préalable une communication (sort de langage animal) et une relation de confiance (sort réussi d'amitié animale) avec l'animal ciblé. Le sortilège d'Alliance crée alors entre lui et le magicien un lien magique extrêmement fort et durable.\nL'un et l'autre ressentent toujours où se trouve leur compagnon, même à des kilomètres, et quelles émotions et pensées superficielles l'habitent. L'animal partage une partie de la conscience du magicien et voit par conséquent son intelligence augmenter. Il est ainsi toujours capable de comprendre avec précision le magicien.\nEn se concentrant et en fermant les yeux, le magicien peut percevoir ce que voit et entend l'animal. Il ressent également ses émotions, comme s'il avait lancé un sort d'Empathie. Enfin, il communique très facilement avec son compagnon, à la fois par la parole (sort permanent de Langage animal) et par une forme limitée de télépathie (l'animal interprète alors les émotions du magicien et peut comprendre des choses simples comme « reviens » « sois prudent » ou « surveille »). Pour cette dernière possibilité, la distance n'intervient pas.\nLeur alliance dure jusqu'à ce que la mort frappe l'un des deux compagnons. S'il s'agit de l'animal, le magicien perd 1 point de constitution pour une durée de 2 ans. Jusqu'à cette issue funeste, l'animal fait tout pour aider son protecteur. Il préférera même mourir à sa place. Une mort « naturelle » de l'animal (de vieillesse ou de maladie) n'entraîne pas la perte d'un point de constitution.\nSi plus de 10 kilomètres les séparent durant toute une journée, le magicien cesse de récupérer de sa fatigue. Dès lors, pour chaque jour qui passe et tant que les 2 compagnons ne se sont pas rejoints, il perd 1 point de fatigue supplémentaire. Quand il atteint un score de 0, il devient incapable de marcher et se tient à peine debout. Après une semaine dans cet état, l'alliance est définitivement rompue et il retrouve sa vigueur naturelle. Un magicien ne peut en aucun cas provoquer volontairement la rupture de l'alliance avec son compagnon."
            },
            "Toile d'araignée": {
                level: 4,
                portée: "20 m",
                incantation: "4 s",
                durée: "10 min",
                sauvegarde: "Co+1",
                zone: "15 m2",
                description: "Une toile gluante jaillit des mains du lanceur et va se fixer sur 2 points d'attache opposés (2 murs, etc.) choisis par le magicien.\nSi les points d'amarrage sont solides, les créatures prises dans la toile restent collées à elle jusqu'à ce qu'elles parviennent à la déchirer ou la couper suffisamment pour s'en libérer. Pour ce faire, elles doivent réussir un nombre de jets sous la Force égal à 5 moins la marge de réussite éventuelle de leur sauvegarde (un jet de force réussi avec une marge de 10 ou plus compte double).\nSi elle n'est pas correctement fixée (absence de points d'amarrage ou points d'amarrage fragiles), la toile englue ceux qui sont pris en son sein mais ils peuvent s'en libérer facilement (jets de force ci-dessus réussis automatiquement).\nUne créature prise dans la toile ne peut entreprendre aucune autre action physique que d'essayer de se libérer. Un assaillant peut se frayer pendant un tour un chemin dans la toile pour l'attaquer ensuite, mais il est gêné et subit un malus de -4 à ses jets d'attaque. La créature immobilisée par la toile voit en revanche sa feinte de corps divisée par quatre et ne peut ni parer ni esquiver. La toile lui confère toutefois 2 points d'armure sur toutes les zones.\nSi le magicien lance une seconde toile d'araignée sur la première, les créatures encore prisonnières subissent cette nouvelle toile sans avoir la possibilité d'un jet de sauvegarde et sont donc engluée pour cinq jets de force réussis supplémentaires. En revanche, la protection que leur procure ce réseau enchevêtré de filaments durs et gluants augmente avec leur nombre : un assaillant attaquant une créature prise dans cette double toile subit un malus de -6 à son jet d'attaque et la toile confère à la créature prisonnière une protection de 4 points d'armure."
            },
            "Distorsion du bois": {
                level: 4,
                portée: "10 m",
                incantation: "3 s",
                durée: "1 jour",
                sauvegarde: "-",
                zone: "1 m3",
                description: "Grâce à ce sortilège, le magicien peut modifier la forme d'un objet en bois (vivant ou non) suivant ses souhaits. Il ne peut néanmoins étendre ou réduire chacune des dimensions de l'objet d'un facteur supérieur à 5. De plus, celui-ci doit conserver le même volume avant et après la transformation. Il est en revanche possible d'insérer des trous qui n'existaient pas.\nCe sort a donc de multiples applications : gauchir une porte pour la coincer, y pratiquer une ouverture pour la franchir ou creuser une niche dans un tronc n'en sont que quelques exemples."
            },
            "Accélération de la guérison": {
                level: 4,
                portée: "5 m",
                incantation: "3 s",
                durée: "spéciale",
                sauvegarde: "-",
                zone: "1 créature",
                description: "Ce sort permet de stabiliser l'état d'une créature blessée et d'accélérer sa guérison naturelle. Il stoppe l'écoulement du sang par les blessures, atténue la douleur et renforce magiquement le processus de guérison.\nL'état physique de la créature ciblée ne s'améliore pas immédiatement ; par exemple, elle ne devient pas subitement capable de courir malgré sa fracture à la jambe. En revanche, il ne détériore plus. Seules les blessures les plus graves, telles que celles susceptibles d'entraîner la mort ou la perte d'un membre en quelques tours, échappent à la capacité de stabilisation du sort ; et encore celui-ci retarde-t-il significativement leur issue.\nL'ensemble des blessures portées par la créature ciblée au moment du sort sont affectées par celui-ci et se mettent à guérir à un rythme accéléré par rapport à la normale. En termes de jeu, elles guérissent 4 fois plus vite que le rythme naturel. La récupération de points de vie est ainsi 3 fois plus rapide. Une fois que chaque blessure est entièrement guérie, la magie qui soutenait sa guérison se dissipe. Une fois que toutes les blessures sont guéries, le sort prend fin. En revanche, les nouvelles blessures subies par la créature postérieurement au lancement du sort ne sont pas affectées par celui-ci et évoluent normalement."
            },

            // Niveau 5
            "Enchevêtrement": {
                level: 5,
                portée: "100 m",
                incantation: "5 s",
                durée: "1 h",
                sauvegarde: "-",
                zone: "1000 m2",
                description: "Ce sort provoque une brusque croissance de tous les végétaux dans la zone d'effets. Pour qu'il soit réellement efficace, il est donc nécessaire que s'y trouve une densité raisonnable d'herbes, d'arbres ou de buissons. La zone d'effets peut prendre la forme souhaitée par le magicien, sans pour autant que sa plus grande dimension dépasse 10 fois sa plus petite.\nLes végétaux poussent jusqu'à former un réseau particulièrement dense couvrant toute la zone choisie par le magicien. Ils sont protégés des feux naturels pour toute la durée du sort. Une créature se frayant un passage à coups d'épée ne progressera que d'environ 50 cm par minute et au prix d'une fatigue importante. Une créature se trouvant dans le réseau au moment de sa croissance sera expulsée de celui-ci, du côté choisi par le magicien."
            },
            "Mur d'épines": {
                level: 5,
                portée: "20 m",
                incantation: "2 s",
                durée: "30 min",
                sauvegarde: "-",
                zone: "10m x 4m x 2m",
                description: "Un mur formé de lianes et de ronces enchevêtrées apparaît à l'endroit souhaité par le magicien. Il est cependant nécessaire qu'il repose sur une surface solide, et qu'il dispose de quelques points d'appui sur les 2 côtés.\nLes lianes et les ronces composant ce réseau très dense sont extraordinairement résistantes. Il faut plusieurs coups d'épée pour venir à bout d'une seule et elles ne brûlent pas. Une créature qui, après un pénible travail pour dégager un chemin, traverse le mur est durement écorchée par les épines, et perd de 1 à 4 points de vie suivant la densité restante du mur."
            },
            "Neutraliser le poison": {
                level: 5,
                portée: "toucher",
                incantation: "5 s",
                durée: "permanent",
                sauvegarde: "-",
                zone: "1 créature",
                description: "Tout poison présent dans le corps de la créature touchée est instantanément neutralisé. Les effets qu'il a déjà eus sur sa victime ne disparaissent pas, mais il n'en cause plus de nouveau. Il est totalement évacué de l'organisme.\nCe sort est efficace contre n'importe quel poison, même le plus virulent, à la seule condition d'être appliqué à temps.\nIl peut également être appliqué à un aliment ou une boisson, afin de les rendre sans danger."
            },

            // Niveau 6
            "Invocation animale mineure": {
                level: 6,
                portée: "-",
                incantation: "10 s",
                durée: "4 h",
                sauvegarde: "-",
                zone: "boule de 5 km",
                description: "Au moment où il lance ce sort, le magicien ressent, sans localiser ses représentants, la totalité des espèces animales présentes dans la zone d'effets. Il choisit alors celle qu'il désire appeler.\nUn ou plusieurs animaux de cette race, pour un total de 100 points de vie, se mettent en route pour le rejoindre. Tous ces animaux, dès qu'ils arrivent à proximité du magicien, sont automatiquement et jusqu'à la fin du sort sous l'effet d'un sort de Langage animal et d'Amitié animale lancé par celui-ci. Ils seront prêts à combattre pour lui et à risquer leur vie."
            },
            "Sens animaux": {
                level: 6,
                portée: "-",
                incantation: "3 s",
                durée: "1 h",
                sauvegarde: "-",
                zone: "le magicien",
                description: "Le magicien modifie sa perception de son environnement. Il s'identifie en quelque sorte à plusieurs animaux à la fois, en empruntant à chacun l'un de ses sens. Il est nécessaire que le magicien ait déjà vu chacun des animaux dont il utilise un sens.\nPar exemple, le magicien pourra grâce à ce sort voir comme un aigle, entendre comme un chat, posséder l'odorat d'un requin et ressentir en même temps les vibrations du sol aussi bien qu'un serpent."
            },
            "Armure d'écorce": {
                level: 6,
                portée: "toucher",
                incantation: "5 s",
                durée: "1 h",
                sauvegarde: "-",
                zone: "1 créature",
                description: "La peau de la créature touchée se couvre d'une pellicule d'écorce. Celle-ci constitue une véritable armure naturelle. Elle diminue automatiquement de 4 points tous les dommages physiques que la créature reçoit. Cela est valable tant pour les coups d'épée que les sortilèges de boule de feu, par exemple. Cette protection est cumulable avec celle procurée le cas échéant par son armure.\nCette pellicule est suffisamment souple et fine pour ne gêner ni les mouvements ni les sensations de la créature. De plus, elle ne s'enflamme pas au contact du feu."
            },

            // Niveau 7
            "Invocation d'insectes": {
                level: 7,
                portée: "20 m",
                incantation: "7 s",
                durée: "30 s",
                sauvegarde: "- (Foi)",
                zone: "boule de 5m",
                description: "Pour être efficace, ce sort doit être lancé dans un environnement où vivent de nombreux insectes. Cette restriction implique en général une utilisation en extérieur uniquement.\nRépondant à l'appel du magicien, des milliers d'insectes se concentrent au cours de l'incantation dans la zone qu'il leur indique, et attaquent ceux qui s'y trouvent. Tous les types d'insectes volants et rampants présents dans un rayon de 2 kilomètres sont représentés dans cet essaim. Le magicien peut décider de fixer celui-ci à un endroit précis ou de l'attacher à une créature. Cette dernière peut néanmoins éviter ce lien indésirable en réussissant un jet de sauvegarde sous son don foi : si la sauvegarde est réussie, l'essaim si fixe à l'endroit où elle se trouve et ne la suit pas ensuite dans ses déplacements ; si en revanche la sauvegarde est ratée, l'essaim la suit dans ses mouvements. Jusqu'à la fin du sort.\nChaque créature se trouvant dans l'essaim perd 1 point de vie tous les 2 tours du fait des multiples piqûres. De plus, il lui est extrêmement difficile de se concentrer. Elle ne peut donc pas lancer de sort et effectue toutes ses actions avec un malus de -4 (hormis sauvegardes et esquives)."
            },
            "Forme animale": {
                level: 7,
                portée: "-",
                incantation: "5 s",
                durée: "1 h",
                sauvegarde: "-",
                zone: "le magicien",
                description: "Ce sort permet au magicien de se transformer en un animal. Il n'y a que 3 limitations à cette transformation.\nTout d'abord, le magicien ne peut se métamorphoser en un animal de poids plus de 10 fois supérieur ou 40 fois inférieur au sien (ces proportions pouvant faire l'objet de modulations des effets du sort, voir chapitre « Jouer la magie »). Ensuite, il doit avoir déjà vu au moins une fois un animal de cette espèce. Enfin, il doit effectivement s'agir d'un animal et non d'un humanoïde (appartenant à une des races décrites dans le chapitre « Les Races » du Livre du Monde) ou d'une créature surnaturelle.\nCette transformation s'opère durant les 5 secondes d'incantation. Ce que le magicien transporte avec lui (jusqu'à 25 kg) est également intégré dans son nouveau corps.\nLe magicien conserve son esprit, mais change totalement de corps. Il est intuitivement capable d'utiliser sa nouvelle forme. En revanche, il ne peut plus lancer de sortilège (sa nouvelle forme interagit trop avec les ondes magiques qu'émet son esprit), ni même parler. En cas de combat, il possède les mêmes scores que l'animal dont il a pris la forme.\nLe magicien peut changer de forme autant de fois qu'il le veut tant que dure le sort. Cependant, chaque transformation en un animal différent des précédents augmente le temps nécessaire au changement de 5 secondes. Ainsi, une seconde métamorphose exigera 10 secondes, une troisième en demandera 15 ; revenir à une forme antérieure (y compris son apparence normale) prendra au magicien autant de temps que la dernière transformation effectuée."
            },
            "Forme végétale": {
                level: 7,
                portée: "-",
                incantation: "5 s",
                durée: "2 h",
                sauvegarde: "-",
                zone: "le magicien",
                description: "Ce sort est identique à celui de « Forme animale », mais s'applique à des transformations en végétaux (plantes, arbres, etc.), et non en animaux.\nIl existe cependant quelques particularités. Tout d'abord, la limitation de poids s'étend ici de 200 fois plus (un grand arbre) à 60 fois moins que le poids du magicien. Ensuite, le magicien conserve une partie de ses facultés de mouvement. Sous forme d'arbre, il pourra ainsi marcher sur ses racines (comme un arbre dieu elfique) ; sous forme de liane, il pourra glisser sur le sol comme un serpent, etc. La vitesse maximale que peut atteindre le magicien sous forme végétale est de 50 cm à la seconde.\nEnfin, le magicien conserve ses perceptions. Il n'est pas capable de parler, en revanche il entend, il voit et il sent. Il devient même sensible à certaines phéromones ou pollens."
            },

            // Niveau 8
            "Fusion dans la nature": {
                level: 8,
                portée: "-",
                incantation: "5 s",
                durée: "30 min",
                sauvegarde: "-",
                zone: "le magicien",
                description: "Ce sortilège permet au magicien (ainsi que son équipement, jusqu'à 25 kg) de se fondre dans la nature qui l'entoure et d'en devenir pour un temps partie intégrante. Pendant l'incantation, le magicien s'intègre progressivement à un végétal (le plus souvent un arbre) proche de lui.\nIl continue à percevoir son environnement exactement comme s'il conservait son enveloppe corporelle habituelle. Il reste de plus parfaitement conscient et peut à ce titre lancer des sortilèges (avec simplement le malus habituel de -8 exprimant qu'il ne peut ni bouger ni parler). Il est capable de se déplacer de végétal en végétal, par l'intermédiaire du sol et des racines, à la vitesse d'environ 1 mètre par seconde.\nEtant dépourvu de toute enveloppe corporelle, le magicien n'est pas en mesure d'accomplir des actions physiques. A contrario, il est insensible aux attaques physiques (y compris celles par sortilèges). Sa grande mobilité le rend par ailleurs très difficile à atteindre par des sortilèges mentaux : le repérer nécessite un jet de Sentir la magie avec un malus de -6 et même alors le magicien bénéficie d'un bonus de +2 à sa sauvegarde.\nPendant toute la durée du sort, le magicien peut autant de fois qu'il le souhaite ressortir de la nature pour reprendre sa forme normale et fusionner à nouveau avec la nature environnante. Le passage dans un sens ou l'autre nécessite chaque fois 5 secondes.\nSi tous les végétaux qui l'environnent sont détruits (par exemple par un incendie), le magicien est contraint de regagner prématurément sa forme habituelle (ou de mourir en même temps que ces végétaux, mais c'est rarement l'issue qu'il choisit)."
            },

            // Niveau 9
            "Croissance animale": {
                level: 9,
                portée: "20 m",
                incantation: "10 s",
                durée: "2 h",
                sauvegarde: "-",
                zone: "100 pv d'animaux",
                description: "Ce sort permet au magicien d'augmenter la taille et la puissance des animaux ciblés, dont le total des points de vie ne doit pas dépasser 100. L'augmentation dépend de la taille initiale des animaux et varie d'environ 5 fois pour un écureuil à 2 fois pour un éléphant.\nLes capacités des animaux concernés sont augmentées à peu près dans les mêmes proportions. Ils deviennent plus intelligents, plus forts, plus résistants. Le maître du jeu décide de la façon dont leurs scores de combat sont améliorés. Typiquement, pour des gros animaux, ils sont multipliés par 1,5 (un score de +4 devient +6). Les points de vie, de fatigue, d'éventuelle armure naturelle, etc., sont quant à eux multipliés proportionnellement à la taille."
            },
            "Télépathie avec la nature": {
                level: 9,
                portée: "-",
                incantation: "15 s",
                durée: "15 min",
                sauvegarde: "-",
                zone: "boule de 100m *",
                description: "Le magicien devient capable de communiquer par télépathie avec toutes les créatures vivantes non humanoïdes qui se trouvent à moins de 30 mètres de lui. La communication est collective, c'est à dire que le magicien parle en même temps à toutes ces créatures, qu'il perçoit simultanément tout ce qu'elles veulent mentalement lui dire et qu'il peut décider de transmettre automatiquement cette perception à toutes les créatures mentalement connectées avec lui.\nLa communication ne souffre d'aucune barrière de langage, puisqu'elle concerne directement les pensées. Les créatures avec lesquelles il communique sont a priori bien disposées envers le magicien. Elles répondront donc de leur mieux à ses questions, et accepteront de lui prêter assistance si cela ne constitue pas une menace réelle pour elles-mêmes.\nSi le magicien se déplace, la zone d'effets se déplace avec lui. Toute nouvelle créature entrant (de son fait ou à la suite du mouvement du magicien) dans la zone d'effets du sort pendant qu'il est actif est aussitôt consciente de la présence du magicien, qui est vu comme un ami, et devient aussitôt capable de communiquer mentalement avec lui. Le lien est a contrario rompu avec toute créature sortant (de son fait ou à la suite du mouvement du magicien) de la zone d'effets."
            },
            "Croissance végétale": {
                level: 9,
                portée: "20 m",
                incantation: "10 s",
                durée: "4 h",
                sauvegarde: "-",
                zone: "jusqu'à 4 végétaux",
                description: "Ce sort permet au magicien d'augmenter la taille d'un végétal. L'augmentation dépend de la taille initiale du végétal, et varie d'environ 100 fois pour une mousse à 2 fois pour un grand arbre.\nLes capacités éventuelles du végétal sont augmentées à peu près dans les mêmes proportions. Il devient plus intelligent, plus fort, plus résistant. S'il y a lieu, le maître du jeu décide de la façon dont ses scores de combat sont améliorés."
            },

            // Niveau 10
            "Communion avec la nature": {
                level: 10,
                portée: "-",
                incantation: "1 min",
                durée: "15 min",
                sauvegarde: "-",
                zone: "le magicien",
                description: "Ce sortilège permet au magicien d'entrer en communion avec son environnement vivant afin d'obtenir des informations. Le mage met environ 1 minute (le temps de lancement du sort) à se mettre en harmonie avec les animaux et les végétaux du lieu où il se trouve.\nLe magicien a alors accès à la mémoire collective des créatures vivantes de ce lieu. Il peut y puiser et revivre les événements passés exactement comme s'il avait été présent. Pendant toute la durée du sort, il peut se mouvoir mentalement à n'importe quel moment du passé.\nCe passé doit cependant correspondre au lieu où il se trouve et à un événement effectivement vécu par une créature présente. Plus l'événement sera récent et plus l'image sera précise, puisque plus elle sera la somme de contributions nombreuses. En effet, un événement datant de 100 ans n'aura été sans doute vécu que par quelques arbres encore vivants. En revanche, un événement du jour précédent pourra être revécu avec une grande précision par toute la faune et la flore du lieu.\nLe magicien doit simplement se concentrer sur le moment qu'il veut revivre. La description mentale de ce moment doit être assez précise pour ne correspondre qu'à un événement du passé. Le magicien peut par exemple penser « comment se présentait ce lieu il y a dix ans ? », ou encore « à quand remonte le dernier passage de créatures humanoïdes et à quoi ressemblaient-elles ? », ou encore aussi « telle personne est-elle déjà venue ici ? » Toute l'opération se déroule presque exactement comme si c'était dans sa propre mémoire que fouillait le magicien."
            },
            "Voyage naturel": {
                level: 10,
                portée: "-",
                incantation: "7 s",
                durée: "1 h",
                sauvegarde: "-",
                zone: "le magicien",
                description: "Ce sort est une version plus puissante du sortilège de Fusion dans la nature. En plus des effets ce celui-ci, le magicien a la possibilité de se déplacer de végétal en végétal à une vitesse très élevée et de couvrir de grandes distances.\nLa vitesse maximale qu'il peut atteindre dépend légèrement de la densité de végétaux (il ne peut notamment pas aller à un endroit presque désertique), mais est en règle générale de l'ordre de 50 kilomètres par heure."
            },

            // Niveau 12
            "Protection contre la nature": {
                level: 12,
                portée: "-",
                incantation: "5 s",
                durée: "2 h",
                sauvegarde: "-",
                zone: "boule de 5m *",
                description: "Grâce à ce sort, le magicien et ce(ux) qui se trouve(nt) suffisamment proche(s) de lui sont protégés contre l'action de tout animal ou végétal (la zone d'effets suit le magicien dans ses déplacements).\nL'effet principal de ce sort est de rendre impossible l'attaque du magicien par un animal. Celui-ci éprouvera une crainte et un respect tels à l'égard du magicien qu'il ne pourra en aucune façon se résoudre à lui nuire. De même, le magicien se trouvera protégé contre toutes les substances d'origine animale ou végétale ; il sera ainsi insensible aux poisons préparés avec de telles substances comme ingrédient de base. Enfin, aucun sortilège de la liste de la Nature (autres que ceux lancés par lui-même) ne peut fonctionner à proximité de lui, de sorte qu'il pourra traverser sans dommage un Mur d'épines et voir s'ouvrir devant lui (et se refermer derrière lui) une zone ayant reçu un sort d'Enchevêtrement ou une Toile d'araignée."
            },

            // Niveau 15
            "Invocation animale majeure": {
                level: 15,
                portée: "-",
                incantation: "1 min",
                durée: "12 h",
                sauvegarde: "-",
                zone: "spéciale",
                description: "Répondant à l'appel du magicien, toutes les espèces d'animaux se trouvant à moins d'une heure du magicien vont lui proposer leur aide (seuls les animaux déjà sous l'effet d'un sort ignorent cet appel). Le magicien est naturellement conscient de tous les animaux qui ont entendu son appel et procède à un choix parmi ceux-ci afin de ne recevoir l'aide que d'un nombre d'animaux représentant un total cumulé de 1000 points de vie. Tous ces animaux, dès qu'ils arrivent à proximité du magicien, sont automatiquement et jusqu'à la fin du sort sous l'effet d'un sort de Langage animal et d'Amitié animale lancé par celui-ci. Ils seront prêts à combattre pour lui et à risquer leur vie. De plus, le magicien peut donner à chacun ou à tous des injonctions mentales qu'ils comprennent.\nL'efficacité de ce sortilège est bien sûr extrêmement dépendante de l'endroit où il est utilisé. En plein désert il ne sera qu'une aide médiocre, tandis qu'il revêt une puissance extraordinaire en pleine forêt. Sa principale limitation reste cependant que les animaux invoqués par le magicien conservent leur intelligence naturelle et ne sont donc pas capables d'effectuer des missions complexes."
            },

            // Niveau 20
            "Chef de clan": {
                level: 20,
                portée: "-",
                incantation: "2 min",
                durée: "1 semaine",
                sauvegarde: "-",
                zone: "le magicien",
                description: "Ce sortilège confère au magicien un pouvoir presque absolu sur une race d'animaux de son choix.\nTous les animaux de cette race présents dans un rayon de 15 km autour du magicien sont conscients de sa présence et se mettent en route pour le rejoindre et l'aider. Seuls les animaux déjà sous l'effet d'un sortilège ne répondent pas à cet appel.\nPendant toute la durée du sort, tout animal de cette race s'approchant à moins de 15 km du magicien subit aussitôt son influence ; inversement cette influence cesse d'affecter tout animal qui se trouve à un moment éloigné de plus de 15 km du magicien.\nChacun des animaux est vis à vis du magicien comme sous le coup d'un sortilège d'Alliance : le magicien est à tout moment parfaitement conscient de sa localisation, peut en se concentrant percevoir le monde à travers ses sens et est lié à lui par une forme limitée d'empathie/télépathie qui lui permet de lui donner des ordres simples, comme « cache toi », « reviens » « sois prudent » ou « surveille ». Le magicien est de plus sous l'effet d'un sortilège de Langage animal vis à vis de la race choisie, qui lui permet de converser avec ses représentants pour obtenir des renseignements précis ou donner des consignes un peu plus complexes (la complexité des ordres exécutables par les animaux reste cependant limitée par leur intelligence).\nLes animaux de la race choisie par le magicien considèrent celui-ci comme leur chef incontestable et lui obéissent aveuglément. Ils mourront pour lui sans l'ombre d'une hésitation. De plus, tant qu'ils sont sous son influence, ils sont insensibles à tout autre sortilège visant à obtenir une influence sur eux, comme Langage animal ou Amitié animale par exemple."
            },
            "Malédiction de la nature": {
                level: 20,
                portée: "20 m",
                incantation: "5 s",
                durée: "2 ans",
                sauvegarde: "Mag-5",
                zone: "1 créature",
                description: "Le magicien utilise ce sortilège lorsqu'il estime qu'une créature est malfaisante et porte atteinte à l'épanouissement des autres êtres vivants. Il la marque alors d'un sceau d'infamie, d'une malédiction qui la poursuivra sans aucun répit jusqu'à l'expiration du sortilège.\nL'empreinte de cette malédiction est instinctivement ressentie par tous les animaux et tous les végétaux. Ils cherchent de toutes leurs forces à nuire à la victime de la malédiction : les ronces la grifferont, les broussailles se refermeront devant elle, les arbres laisseront tomber leurs branches mortes sur sa tête et de leurs racines lui feront des croche-pieds ; les moustiques la piqueront, les mouches bourdonneront sans cesse autour d'elle, les oiseaux déverseront leurs fientes sur elle, les chiens la mordront, les animaux sauvages d'une certaine force l'attaqueront, par leur harcèlement continuel tous l'empêcheront de prendre le moindre repos ou de jouir de la moindre quiétude.\nLa victime subit également un malus de moins 12 au lancement de tout sortilège de la liste de la Nature et de moins 6 au lancement de tout sortilège de la liste de Magie pure. Enfin, tout magicien maîtrisant des sortilèges de la liste de la Nature d'un niveau supérieur ou égal à 8 ressentira cette malédiction et cherchera, sauf exception, à s'y associer."
            }
        };

        // Fonction pour créer une flèche SVG entre deux éléments
        function createArrow(fromElement, toElement, svg) {
            const fromRect = fromElement.getBoundingClientRect();
            const toRect = toElement.getBoundingClientRect();
            const containerRect = document.getElementById('diagramContainer').getBoundingClientRect();

            // Calculer les positions relatives au conteneur avec plus de précision
            const fromX = fromRect.left + fromRect.width / 2 - containerRect.left;
            const fromY = fromRect.bottom - containerRect.top + 0; // Commencer 8px au-dessus du bas
            const toX = toRect.left + toRect.width / 2 - containerRect.left;
            const toY = toRect.top - containerRect.top - 0; // Arriver 8px en dessous du haut

            // Vérifier que les positions sont valides
            if (isNaN(fromX) || isNaN(fromY) || isNaN(toX) || isNaN(toY)) {
                console.log('Position invalide pour la flèche');
                return;
            }

            // Créer la ligne SVG avec un style plus visible
            const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            line.setAttribute('x1', fromX);
            line.setAttribute('y1', fromY);
            line.setAttribute('x2', toX);
            line.setAttribute('y2', toY);
            line.setAttribute('stroke', '#666');
            line.setAttribute('stroke-width', '2.5');
            line.setAttribute('marker-end', 'url(#arrowhead)');
            line.setAttribute('opacity', '0.75');

            svg.appendChild(line);
        }

        // Fonction pour créer toutes les flèches
        function createAllArrows() {
            // Attendre que les éléments soient rendus
            setTimeout(() => {
                // Supprimer l'ancien SVG
                const oldSvg = document.querySelector('.diagram-svg');
                if (oldSvg) {
                    oldSvg.remove();
                }

                // Vérifier que tous les éléments existent
                const allElements = document.querySelectorAll('.spell-node');
                console.log(`Éléments trouvés: ${allElements.length}`);

                if (allElements.length === 0) {
                    console.log('Éléments non trouvés, nouvelle tentative...');
                    setTimeout(createAllArrows, 500);
                    return;
                }

                // Vérifier que le conteneur existe
                const container = document.getElementById('diagramContainer');
                if (!container) {
                    console.log('Conteneur non trouvé');
                    return;
                }

                // Créer le SVG
                const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                svg.className = 'diagram-svg';
                svg.setAttribute('width', "100%");
                svg.setAttribute('height', "100%");
                svg.style.position = 'absolute';
                svg.style.top = '0';
                svg.style.left = '0';
                svg.style.zIndex = '0';

                // Créer le marqueur de flèche
                const defs = document.createElementNS('http://www.w3.org/2000/svg', 'defs');
                const marker = document.createElementNS('http://www.w3.org/2000/svg', 'marker');
                marker.setAttribute('id', 'arrowhead');
                marker.setAttribute('markerWidth', '6');
                marker.setAttribute('markerHeight', '4');
                marker.setAttribute('refX', '5');
                marker.setAttribute('refY', '2');
                marker.setAttribute('orient', 'auto');

                const polygon = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
                polygon.setAttribute('points', '0 0, 6 2, 0 4');
                polygon.setAttribute('fill', '#666');
                polygon.setAttribute('opacity', '0.8');

                marker.appendChild(polygon);
                defs.appendChild(marker);
                svg.appendChild(defs);

                // Créer les connexions selon le diagramme de la Liste de la Nature
                const connections = [
                    // Chaîne de base : localisation et connaissance
                    ['Localisation des plantes', 'Langage des plantes'],
                    ['Localisation des animaux', 'Apaiser les animaux'],
                    ['Connaissance des animaux', 'Langage animal'],
                    ['Connaissance des animaux', 'Toile d\'araignée'],
                    ['Connaissance des plantes', 'Langage des plantes'],
                    ['Connaissance des plantes', 'Accélération de la guérison'],
                    ['Accélération de la guérison', 'Neutraliser le poison'],
                    ['Apaiser les animaux', 'Amitié animale'],
                    ['Langage animal', 'Amitié animale'],
                    ['Amitié animale', 'Alliance'],
                    ['Langage des plantes', 'Distorsion du bois'],
                    ['Alliance', 'Invocation animale mineure'],
                    ['Toile d\'araignée', 'Enchevêtrement'],
                    ['Toile d\'araignée', 'Sens animaux'],
                    ['Accélération de la guérison', 'Neutraliser le poison'],
                    ['Armure d\'écorce', 'Forme végétale'],
                    ['Enchevêtrement', 'Mur d\'épines'],
                    ['Distorsion du bois', 'Enchevêtrement'],
                    ['Distorsion du bois', 'Mur d\'épines'],
                    ['Mur d\'épines', 'Armure d\'écorce'],
                    ['Invocation animale mineure', 'Invocation animale majeure'],
                    ['Invocation animale mineure', 'Croissance animale'],
                    ['Invocation animale mineure', 'Invocation d\'insectes'],
                    ['Forme animale', 'Croissance animale'],
                    ['Forme animale', 'Fusion dans la nature'],
                    ['Forme végétale', 'Fusion dans la nature'],
                    ['Forme végétale', 'Croissance végétale'],
                    ['Fusion dans la nature', 'Télépathie avec la nature'],
                    ['Fusion dans la nature', 'Voyage naturel'],
                    ['Télépathie avec la nature', 'Communion avec la nature'],
                    ['Communion avec la nature', 'Protection contre la nature'],
                    ['Communion avec la nature', 'Malédiction de la nature'],
                    ['Invocation animale majeure', 'Chef de clan']
                ];

                let createdArrows = 0;
                connections.forEach(([from, to]) => {
                    const fromElement = document.querySelector(`[data-spell="${from}"]`);
                    const toElement = document.querySelector(`[data-spell="${to}"]`);

                    if (fromElement && toElement) {
                        console.log(`Création flèche: ${from} -> ${to}`);
                        createArrow(fromElement, toElement, svg);
                        createdArrows++;
                    } else {
                        console.log(`Éléments non trouvés: ${from} -> ${to}`);
                        console.log(`From: ${fromElement ? 'trouvé' : 'non trouvé'}, To: ${toElement ? 'trouvé' : 'non trouvé'}`);
                    }
                });

                // Ajouter le SVG au conteneur
                document.getElementById('diagramContainer').appendChild(svg);

                console.log(`Flèches créées: ${createdArrows}/${connections.length}`);
                console.log(`Position SVG: top=0, left=0, z-index=10`);
            }, 500);
        }

        // Créer les flèches au chargement de la page
        window.addEventListener('load', createAllArrows);

        // Gestion des clics sur les sorts
        document.addEventListener('click', function (e) {
            if (e.target.classList.contains('spell-node')) {
                const spellName = e.target.dataset.spell;
                const spellData = spellsData[spellName];

                if (spellData) {
                    // Afficher les informations du sort
                    document.getElementById('spellName').textContent = spellName;
                    document.getElementById('spellDescription').textContent = spellData.description;
                    document.getElementById('spellLevel').textContent = spellData.level;
                    document.getElementById('spellInfo').style.display = 'block';
                    document.getElementById('spellPortée').textContent = spellData.portée;
                    document.getElementById('spellIncantation').textContent = spellData.incantation;
                    document.getElementById('spellDurée').textContent = spellData.durée;
                    document.getElementById('spellSauvegarde').textContent = spellData.sauvegarde;
                    document.getElementById('spellZone').textContent = spellData.zone;

                    // Animation du sort cliqué
                    e.target.classList.add('clicked');
                    setTimeout(() => {
                        e.target.classList.remove('clicked');
                    }, 1000);
                }
            }
        });

        // Fermer les informations en cliquant ailleurs
        document.addEventListener('click', function (e) {
            if (!e.target.classList.contains('spell-node') && !e.target.closest('.spell-info')) {
                document.getElementById('spellInfo').style.display = 'none';
            }
        });
    </script>
</body>

</html>